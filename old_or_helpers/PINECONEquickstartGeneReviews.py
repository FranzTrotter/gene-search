# Import the Pinecone library
from pinecone.grpc import PineconeGRPC as Pinecone
from pinecone import ServerlessSpec
import time

# Initialize a Pinecone client with your API key
pc = Pinecone(api_key="pcsk_yMcSm_2J4YaTKzpspLY9ub1T9KW1FvqBLk7LybLvEWfQq921xGwnA8Ld7cQBbPxcYdQBK"
)

# Define a sample dataset where each item has a unique ID, text, and category
data = [
    {
        "id": "rec1",
        "text": "Clinical characteristics The clinical phenotype of alpha-mannosidosis varies considerably, with a wide spectrum of clinical findings and broad variability in individual presentation. At least three clinical types have been suggested in untreated individuals: mild (clinically recognized after age ten years, with myopathy, slow progression, and absence of skeletal abnormalities); moderate (clinically recognized before age ten years, with myopathy, slow progression, and presence of skeletal abnormalities); and severe (obvious progression leading to early death from primary central nervous system involvement or infection). Core features of untreated individuals generally include early childhood-onset non-progressive hearing loss, frequent infections due to immunodeficiency, rheumatologic symptoms (especially systemic lupus erythematosus), developmental delay / intellectual disability, low tone, ataxia, spastic paraplegia, psychiatric findings, bone disease (ranging from asymptomatic osteopenia to focal lytic or sclerotic lesions and osteonecrosis), gastrointestinal dysfunction (including diarrhea, swallowing issues/ aspiration, and enlarged liver and spleen), poor growth, eye issues (including tapetoretinal degeneration and optic nerve atrophy), cardiac complications in adults, and pulmonary issues (including parenchymal lung disease). However, with the advent of enzyme replacement therapy, the natural history of this condition may change. Long-term velmanase alfa (VA) treatment outcomes are still being elucidated, but may include improvement in hearing, immunologic profile, and quality of life (improved clinical outcomes for muscle strength). Similarly, affected individuals who underwent hematopoietic stem cell transplantation (HSCT) experienced improvement in development (with preservation of previously learned skills), ability to participate in activities of daily living, stabilization or improvement in skeletal abnormalities, and improvement in hearing ability, although expressive speech and hearing deficiencies remained the most significant clinical problems after HSCT. Author Affiliations: 1 The Children's Hospital of Philadelphia; Division of Human Genetics and Metabolism, Perelman School of Medicine at the University of Pennsylvania, Philadelphia, Pennsylvania; Email: ficicioglu@chop.edu. 2 Mark Holland Metabolic Unit, Salford Royal NHS Foundation Trust, Salford Care Organisation, Part of the Northern Care Alliance NHS Group, Salford, United Kingdom; Email: karolina.stepien@nca.nhs.uk. Copyright 1993-2024, University of Washington, Seattle. GeneReviews is a registered trademark of the University of Washington, Seattle. All rights reserved. Diagnosis/testing GeneReviews The diagnosis of alpha-mannosidosis is established in a proband by identification of deficiency of lysosomal enzyme acid alpha-mannosidase (typically 5%-10% of normal activity) in leukocytes or other nucleated cells AND/OR by the identification of biallelic pathogenic variants in MAN2B1 by molecular genetic testing. Management Targeted therapies: Velmanase alfa (Lamzede) enzyme replacement therapy (ERT) has been very well tolerated and is now regarded as a standard treatment for alpha-mannosidosis; improvement in both biochemical and functional parameters have been reported in treated individuals. Hematopoietic stem cell transplantation (HSCT) has been offered as a treatment for severe alpha-mannosidosis. While HSCT carries risks, the data suggests it is a feasible therapeutic option for alpha-mannosidosis, with better outcomes achieved by performing it early before complications arise, balancing the risks and benefits. Supportive care: Hearing aids may be helpful for those with sensorineural hearing loss, whereas pressure- equalizing tubes may be helpful for those with conductive hearing loss. Consider palmidronate (Aredia) monthly or zoledronic acid (Aclasta) once a year for osteoporosis or osteopenia. Standard treatment for immunodeficiency / recurrent infections, systemic lupus erythematosus, communicating hydrocephalus, ataxia/ gait abnormalities, poor weight gain / growth issues, eye/vision issues, cardiac valve dysfunction / dilated cardiomyopathy, recurrent chest infections / respiratory dysfunction, developmental delay / intellectual disability, and psychiatric manifestations. Surveillance: At each visit, measure weight, length/height, head circumference, and BMI; monitor growth pattern, developmental progress, and educational needs; assess for depression, including sleep disturbances, anxiety, &/or findings suggestive of psychosis; assess for new manifestations such as ataxia and gait abnormalities; evaluate for asthenia and signs/symptoms of communicating hydrocephalus; assess for muscle pain, joint aches, reduced range of motion, and bone pain; monitor for diarrhea and for size of the liver and spleen; and assess for the number and type of infections. Every six to 12 months in childhood and annually in adults, assess fine motor function, gross motor function, endurance, and muscle strength and tone by physical therapy; and assess for features of ataxia. Every one to two years, or as clinically indicated in those with hearing aids, perform an audiology evaluation. Every two to five years in children, adolescents, and adults, consider DXA bone densitometry scan to assess for osteopenia or osteoporosis; radiographs of the hips/spine may be indicated. Annually (or as clinically indicated), routine biochemical lab assessment to include liver and kidney health, blood glucose levels, fluid and electrolyte balance, and complete blood count (with platelets); consider immunlobulin levels, ESR and C-reactive protein; pulmonary function tests; and ophthalmology evaluation. At regular intervals based on clinical features, consider endocrinology evaluations, including hormonal and lipid profiles; consider assessment of liver and spleen size through ultrasound or MRI imaging; consider electrocardiogram, 24-hour electrocardiogram, and echocardiogram; consider sleep study. For those on ERT, plasma oligosaccharides to assess treatment response as clinically indicated. Post-HSCT evaluation of standard surveillance per hematologist/oncologist, which may include ongoing assessment for chimerism and enzyme activity if indicated. Evaluation of relatives at risk: Testing of all at-risk sibs of any age (including prenatal diagnosis) is warranted to allow for early diagnosis and targeted treatment of alpha-mannosidosis. Evaluations can include molecular genetic testing if the pathogenic variants in the family are known or assay of acid alpha-mannosidase enzyme activity in leukocytes or other nucleated cells if the pathogenic variants in the family are not known. 3 Genetic counseling Alpha-mannosidosis is inherited in an autosomal recessive manner. At conception, each sib of an affected individual has a 25% chance of being affected, a 50% chance of being an asymptomatic carrier, and a 25% chance of being unaffected and not a carrier. Carrier testing for at-risk relatives is possible if the pathogenic variants in the family are known. Prenatal testing for a pregnancy at increased risk is possible by assay of acid alpha- mannosidase enzymatic activity or molecular genetic testing once the pathogenic variants have been identified in the family.",
        "category": "a-mannosidosis" 
    },
    {
        "id": "rec2",
        "text": "Clinical characteristics Alpha-thalassemia (-thalassemia) has two clinically significant forms: hemoglobin Bart hydrops fetalis (Hb Bart) syndrome (caused by deletion/inactivation of all four alpha globin [-globin] genes; --/--), and hemoglobin H (HbH) disease (most frequently caused by deletion/inactivation of three -globin genes;--/-). Hb Bart syndrome, the more severe form, is characterized by prenatal onset of generalized edema and pleural and pericardial effusions as a result of congestive heart failure induced by severe anemia. Extramedullary erythropoiesis, marked hepatosplenomegaly, and a massive placenta are common. Death usually occurs in the neonatal period. HbH disease has a broad phenotypic spectrum: although clinical features usually develop in the first years of life, HbH disease may not present until adulthood or may be diagnosed only during routine hematologic analysis in an asymptomatic individual. The majority of individuals have enlargement of the spleen (and less commonly of the liver), mild jaundice, and sometimes thalassemia-like bone changes. Individuals with HbH disease may develop gallstones and experience acute episodes of hemolysis in response to infections or exposure to oxidant drugs. Diagnosis/testing The diagnosis of Hb Bart syndrome is established in a fetus with characteristic hematologic and hemoglobin (Hb) findings and molecular genetic testing that identifies biallelic pathogenic variants in both HBA1 and HBA2 that result in deletion or inactivation of all four -globin alleles. The diagnosis of HbH disease is established in a proband with hematologic and Hb findings and molecular genetic testing that identifies biallelic pathogenic variants in HBA1 and HBA2 that result in deletion or inactivation of three -globin alleles. Author Affiliations: 1 Hematology-Oncology Department, Schneider Children's Medical Center of Israel, Petah Tiqva, Israel; Email: htamary@tauex.tau.ac.il. 2 Felsenstein Medical Research Center, Petah Tiqva, Israel; Email: odgani@clalit.org.il. Copyright 1993-2024, University of Washington, Seattle. GeneReviews is a registered trademark of the University of Washington, Seattle. All rights reserved. Management GeneReviews Treatment of manifestations: Hb Bart syndrome: intrauterine blood transfusions, improved transfusion strategies, and rarely curative hematopoietic stem cell transplant may allow survival of children. HbH disease: while most individuals are clinically well and survive without any treatment, occasional red blood cell transfusions may be needed during hemolytic or aplastic crises. Red blood cell transfusions are very rarely needed for severe anemia affecting cardiac function and erythroid expansion that results in severe bone changes and extramedullary erythropoiesis. In contrast, persons with non-deletional HbH disease may be more severely affected and transfusion dependent. Prevention of primary manifestations: Because of the severity of Hb Bart syndrome, the occasional presence of congenital anomalies, and the risk for maternal complications, prenatal testing and early termination of pregnancies at risk have usually been considered. However, recent advances in intrauterine and postnatal therapy have increased treatment options, thus complicating the ethical issues for health care providers and families facing an affected pregnancy. Prevention of secondary complications: Monitor individuals with HbH disease for hemolytic/aplastic crisis during febrile episodes; in those who require chronic red blood cell transfusions, iron chelation therapy should be instituted; for those who are not red blood cell transfusion dependent, iron chelation with deferasirox can be considered to reduce liver iron concentration. Surveillance: For HbH disease, hematologic evaluation every six to 12 months; assessment of growth and development in children every six to 12 months; monitoring of iron load with serum ferritin concentration and periodic quantitative measurement of liver iron concentration. Agents/circumstances to avoid: In persons with HbH disease: inappropriate iron therapy and oxidant drugs (i.e., the same drugs to be avoided by individuals with glucose-6-phosphate dehydrogenase deficiency). Evaluation of relatives at risk: Test the sibs of a proband as soon as possible after birth for HbH disease so that monitoring can be instituted. Pregnancy management: Complications reported in pregnant women with HbH disease include worsening anemia, preeclampsia, congestive heart failure, and threatened miscarriage; monitoring for these issues during pregnancy is recommended. Genetic counseling Alpha-thalassemia is usually inherited in an autosomal recessive manner. Hb Bart syndrome: At conception, each sib of a proband with Hb Bart syndrome has a 25% chance of having Hb Bart syndrome (e.g., --/--), a 50% chance of having -thalassemia trait with deletion or inactivation of two - globin genes in cis (e.g., --/), and a 25% chance of being unaffected and not a carrier. HbH disease: The risk to sibs of a proband depends on genotype of the parents. Carrier testing: Family members, members of ethnic groups at risk, and gamete donors should be considered for carrier testing. Couples who are members of populations at risk for -thalassemia trait with a two-gene deletion in cis (--/) can be identified prior to pregnancy as being at risk of conceiving a fetus with Hb Bart syndrome. Prenatal and preimplantation genetic testing may be carried out for couples who are at high risk of having a fetus with Hb Bart syndrome or for a pregnancy in which one parent is a known -thalassemia carrier with a two- gene deletion in cis when the other parent is either unknown or unavailable for testing.",
        "category": "a-thal"
    },
    {
        "id": "rec3",
        "text": "Clinical characteristics Individuals with aromatic L-amino acid decarboxylase (AADC) deficiency typically have complex symptoms, including motor, behavioral, cognitive, and autonomic findings. Symptom onset is in early infancy, typically within the first six months of life. The most common initial symptoms are often nonspecific, and include feeding difficulties, hypotonia, and developmental delay. More specific symptoms include oculogyric crises (which occur in the vast majority of affected individuals, typically starting in infancy), movement disorders (especially dystonia), and autonomic dysfunction (excessive sweating, temperature instability, ptosis, nasal congestion, hypoglycemic episodes). Sleep disturbance is present in a majority of affected individuals and can include insomnia, hypersomnia, or both. Mood disturbance, including irritability and anxiety, are also common. Brain MRI is typically either normal or may demonstrate nonspecific abnormalities, such as mild diffuse cerebral atrophy or delayed myelination. Seizures are an uncommon finding, occurring in fewer than 5% of affected individuals. Diagnosis/testing The diagnosis of AADC deficiency is established in a proband who has the following core diagnostic testing results: biallelic pathogenic variants in DDC identified by molecular genetic testing OR cerebrospinal fluid (CSF) or plasma neurotransmitter profile consistent with AADC deficiency AND significantly reduced AADC enzyme activity in plasma. Author Affiliations: 1 Division of Metabolism, University Children's Hospital Zurich, Zurich, Switzerland; Email: nenad.blau@kispi.uzh.ch. 2 Departments of Pediatrics and Neurology, Nationwide Children's Hospital; Ohio State University College of Medicine, Columbus, Ohio; Email: toni.pearson@nationwidechildrens.org. 3 Developmental Neurosciences, Zayed Centre for Research into Rare Disease in Children, UCL GOS Institute of Child Health; Department of Neurology, Great Ormond Street Hospital, London, United Kingdom; Email: manju.kurian@ucl.ac.uk. 4 Department. of Molecular & Human Genetics Baylor College of Medicine, Houston, Texas; Email: sarah.elsea@bcm.edu. Copyright 1993-2024, University of Washington, Seattle. GeneReviews is a registered trademark of the University of Washington, Seattle. All rights reserved. Management GeneReviews Targeted therapies: Treatments can include the use of dopamine agonists (pramipexole, ropinirole, rotigotine patch, or bromocriptine), MAO inhibitors (selegiline or tranylcypromine), vitamin B6 (pyridoxine, pyridoxal phosphate), folinic acid, and (in rare cases) levodopa in a preparation without carbidopa. Putaminal delivery of eladocagene exuparvovec (Upstaza) was approved in the European Union and United Kingdom for the treatment of individuals aged 18 months and older with a clinical, molecular, and genetically confirmed diagnosis of AADC deficiency with a severe phenotype (i.e., individuals who cannot sit, stand, or walk); this treatment is not currently FDA approved for use in the United States. Supportive care: Feeding therapy with consideration of gastrostomy tube placement or jejunal feeding; anticholinergic drugs and/or sleep induction for movement disorders / oculogyric crisis; xylometazoline or oxymetazoline nasal drops for autonomic dysfunction; melatonin or clonidine for sleep disturbance; and standard therapies for epilepsy, developmental delay / intellectual disability, musculoskeletal issues, bowel dysfunction (constipation, diarrhea, or gastroesophageal reflux disease), strabismus, visual impairment, obstructive sleep apnea, hypoglycemia, and hearing loss. Surveillance: At each visit: measurement of growth parameters; evaluation of nutritional status and safety of oral intake; monitor frequency and severity of oculogyric crises and movement disorders; assess for new manifestations, such as seizures, changes in tone, and movement disorders; monitor developmental progress and educational needs; monitor for behavioral issues and symptoms of anxiety, ADHD, ASD, aggression, & self- injury; clinical assessment for kyphoscoliosis and hip dislocation; monitor for constipation, diarrhea, gastroesophageal reflux, and abdominal discomfort or pain; and monitor for evidence of aspiration, respiratory insufficiency, sleep disturbance, and frequency of respiratory infections. Annually: obtain hip and spinal radiographs (until skeletal maturity); consider cardiology evaluation; consider continuous glucose monitoring, especially in younger affected individuals. Per treating clinicians: ophthalmology evaluation; monitor for cardiac function and rhythm defects; monitor for symptoms of obstructive sleep apnea and nasal congestion. In those on levodopa treatment: monitor CSF neurotransmitters, including 5-methyltetrahydrofolate levels, as clinically indicated to assess for secondary folate deficiency, particularly if neurologic symptoms worsen. In those on bromocriptine therapy: echocardiogram and EKG every 6-12 months to monitor for vavlulopathy caused by valve fibrosis (the risk is lower than with other ergot-derived dopamine agonists such as pergolide, but not absent). Agents/circumstances to avoid: Ergot-derived dopamine agonists with strong serotonergic (5-HT2B) agonist action (pergolide and cabergoline) due to risk of cardiac valvulopathy and other fibrotic complications; levodopa in most affected individuals who do not have ligand binding site pathogenic variants; dopamine receptor antagonists (e.g., metoclopramide, antipsychotic medications), which may worsen primary disease symptoms. Evaluation of relatives at risk: Testing of all at-risk sibs of any age is warranted to allow for early diagnosis and treatment of AADC deficiency. Molecular genetic testing is recommended if the pathogenic variants in the family are known; measurement of CSF neurotransmitters (to evaluate for the characteristic profile) and plasma AADC enzyme activity is recommended if the pathogenic variants in the family are not known. Pregnancy management: Successful pregnancy has been documented in an affected woman with a mild phenotype who took low-dose pramipexole and selegiline during pregnancy. Genetic counseling AADC deficiency is inherited in an autosomal recessive manner. If both parents are known to be heterozygous for a DDC pathogenic variant, each sib of an affected individual has at conception a 25% chance of being affected, a 50% chance of being an asymptomatic carrier, and a 25% chance of being unaffected and not a carrier. Heterozygotes (carriers) are asymptomatic. If both DDC pathogenic variants have been identified in an affected L-Amino Acid Decarboxylase Deficiency 3 family member, molecular genetic carrier testing for at-risk relatives and prenatal and preimplantation genetic testing are possible.",
        "category": "aadc-def"
    },
    {
        "id": "rec4",
        "text": "Clinical characteristics Abetalipoproteinemia typically presents in infancy with failure to thrive, diarrhea, vomiting, and malabsorption of fat. Hematologic manifestations may include acanthocytosis (irregularly spiculated erythrocytes), anemia, reticulocytosis, and hemolysis with resultant hyperbilirubinemia. Malabsorption of fat-soluble vitamins (A, D, E, and K) can result in an increased international normalized ratio (INR). Untreated individuals may develop atypical pigmentation of the retina that may present with progressive loss of night vision and/or color vision in adulthood. Neuromuscular findings in untreated individuals including progressive loss of deep tendon reflexes, vibratory sense, and proprioception; muscle weakness; dysarthria; and ataxia typically manifest in the first or second decades of life. Diagnosis/testing The diagnosis of abetalipoproteinemia is established in a proband with absent or extremely low LDL-cholesterol, triglyceride, and apolipoprotein (apo) B levels and biallelic pathogenic variants in MTTP identified by molecular genetic testing. Management Treatment of manifestations: Adequate caloric intake to alleviate growth deficiency; low-fat diet (10%-20% of total calories from fat); oral essential fatty acid supplementation (up to 1 teaspoon per day of oils rich in polyunsaturated fatty acids, as tolerated); supplementation with vitamin A (100-400 IU/kg/day), vitamin D (800-1,200 IU/day), vitamin E (100-300 IU/kg/day), and vitamin K (5-35 mg/week). Mild anemia rarely requires treatment, although occasionally vitamin B12 or iron therapy may be considered. Dysarthria, ataxia, and hypothyroidism are treated in the standard fashion. Author Affiliations: 1 Department of Clinical Biochemistry, Royal Perth Hospital & Fiona Stanley Hospital Network PathWest Laboratory Medicine WA; School of Medicine, Faculty of Health & Medical Sciences University of Western Australia, Perth, Australia; Email: john.burnett@health.wa.gov.au; Email: amanda.hooper@health.wa.gov.au. 2 Departments of Medicine and Biochemistry, Schulich School of Medicine and Robarts Research Institute, Western University, London, Ontario, Canada; Email: hegele@robarts.ca. Copyright 1993-2024, University of Washington, Seattle. GeneReviews is a registered trademark of the University of Washington, Seattle. All rights reserved. GeneReviews Prevention of primary manifestations: Most complications can be prevented through institution of a low-fat diet with supplementation of fat-soluble vitamins (A, D, E, and K). Surveillance: Assessment of growth parameters at each visit. Complete blood count, INR, reticulocyte count, liver function tests (AST, ALT, GGT, total and direct bilirubin, alkaline phosphatase, and albumin), fat-soluble vitamin levels (vitamin A [retinol], 25-OH vitamin D, and plasma or red blood cell vitamin E concentrations), serum calcium, serum phosphate, serum uric acid, and TSH levels annually. Lipid profile (total cholesterol, triglyceride concentration, LDL-cholesterol, HDL-cholesterol, apo B, and apo A-I) every several years. Ultrasound of the liver every three years. Ophthalmology and neurology evaluations every six to 12 months. Agents/circumstances to avoid: Fatty foods, particularly those rich in long-chain fatty acids. Evaluation of relatives at risk: Sibs of a proband should undergo a full lipid profile and apolipoprotein (apo) B determination to allow for early diagnosis and treatment of findings. If the pathogenic MTTP variants in the family are known, molecular genetic testing may also be used to determine the genetic status of at-risk sibs. In classic abetalipoproteinemia, affected sibs will present shortly after birth with failure to thrive, diarrhea, vomiting, and malabsorption of fat. Pregnancy management: Vitamin A excess can be harmful to the developing fetus. Therefore, women who are pregnant or who are planning to become pregnant should reduce their vitamin A supplement dose by 50%. Additionally, close monitoring of serum beta carotene levels throughout pregnancy is recommended. Because vitamin A is an essential vitamin, vitamin A supplementation should not be discontinued during pregnancy. Genetic counseling Abetalipoproteinemia is inherited in an autosomal recessive manner. At conception, each sib of an affected individual has a 25% chance of being affected, a 50% chance of being an asymptomatic carrier, and a 25% chance of being unaffected and not a carrier. Carrier testing for at-risk relatives and prenatal and preimplantation genetic testing are possible if the pathogenic MTTP variants in the family are known.",
        "category": "ab-lipo-p"
    },
    {
        "id": "rec5",
        "text": "Clinical characteristics Cytochrome P450 oxidoreductase deficiency (PORD) is a disorder of steroidogenesis with a broad phenotypic spectrum including cortisol deficiency, altered sex steroid synthesis, disorders of sex development (DSD), and skeletal malformations of the Antley-Bixler syndrome (ABS) phenotype. Cortisol deficiency is usually partial, with some baseline cortisol production but failure to mount an adequate cortisol response in stress. Mild mineralocorticoid excess can be present and causes arterial hypertension, usually presenting in young adulthood. Manifestations of altered sex steroid synthesis include ambiguous genitalia/DSD in both males and females, large ovarian cysts in females, poor masculinization and delayed puberty in males, and maternal virilization during pregnancy with an affected fetus. Skeletal malformations can manifest as craniosynostosis, mid-face retrusion with proptosis and choanal stenosis or atresia, low-set dysplastic ears with stenotic external auditory canals, hydrocephalus, radiohumeral synostosis, neonatal fractures, congenital bowing of the long bones, joint contractures, arachnodactyly, and clubfeet; other anomalies observed include urinary tract anomalies (renal pelvic dilatation, vesicoureteral reflux). Cognitive impairment is of minor concern and likely associated with the severity of malformations; studies of developmental outcomes are lacking. Diagnosis/testing The diagnosis of PORD can be established by urinary steroid profiling using gas chromatography / mass spectrometry (GC/MS), which documents combined impairment of 17-hydroxylase (CYP17A1) and 21- hydroxylase (CYP21A2) enzymatic activity located at key branch points of cortisol, aldosterone, and sex steroid synthesis. Identification of biallelic POR pathogenic variants on molecular genetic testing confirms the diagnosis. Molecular genetic testing is desirable for all individuals affected by PORD to confirm the diagnosis, but is mandatory if clinical and laboratory features are inconclusive. Author Affiliations: 1 Institute of Metabolism and Systems Research, University of Birmingham, Birmingham, United Kingdom; Email: j.idkowiak@bham.ac.uk; Email: w.arlt@bham.ac.uk. 2 University of Tampa, Tampa, Florida; Email: deborahcragun@gmail.com. 3 Clinical Geneticist, Children's Hospital Medical Center and University of Cincinnati College of Medicine, Cincinnati, Ohio; Email: rob.hopkin@cchmc.org. Copyright 1993-2024, University of Washington, Seattle. GeneReviews is a registered trademark of the University of Washington, Seattle. All rights reserved. Management GeneReviews Treatment of manifestations: Glucocorticoid replacement therapy for cortisol deficiency including stress-dose cover in intercurrent illness; surgery as needed for craniosynostosis, hypospadias, and cryptorchidism in males and clitoromegaly and vaginal hypoplasia in females; dihydrotestosterone treatment has been successful in some males with micropenis; testosterone replacement in males in whom testosterone levels remain relatively low after onset of puberty; females with absent pubertal development may require estrogen replacement therapy; treatment with estradiol to reduce the size of ovarian cysts; endotracheal intubation, nasal stints or tracheotomy, and tracheostomy as needed; physical and occupational therapy for joint contractures and help with fine and gross motor skills. Prevention of secondary complications: Supplementation with appropriate steroid hormones in individuals who are deficient has helped alleviate adrenal crisis, lack of or poor pubertal development in males and females, sleepiness, and fatigue. Early intervention services may improve the outcome for individuals at risk for developmental delays and learning difficulties. Surveillance: Evaluations with a specialist tertiary pediatric endocrine service throughout childhood to closely monitor development and adjust steroid supplementation. Periodic formal developmental assessments in centers with expertise and experience in developmental testing. Evaluation of relatives at risk: It is appropriate to evaluate apparently asymptomatic older and younger sibs of a proband in order to identify as early as possible those who would benefit from initiation of treatment and preventive measures. Genetic counseling PORD is inherited in an autosomal recessive manner. At conception, each sib of an affected individual has a 25% chance of being affected, a 50% chance of being an asymptomatic carrier, and a 25% chance of being unaffected and not a carrier. Carrier testing for at-risk family members and prenatal genetic testing for pregnancies at increased risk are possible if the POR pathogenic variants have been identified in the family. In addition, noninvasive testing of maternal urine steroid excretion by GC/MS can indicate whether the unborn child is affected by PORD from gestational week 12 onwards.",
        "category": "abs"
    }
]

# Convert the text into numerical vectors that Pinecone can index
embeddings = pc.inference.embed(
    model="multilingual-e5-large",
    inputs=[d["text"] for d in data],
    parameters={
        "input_type": "passage", 
        "truncate": "END"
    }
)

print("EMBEDDINGS:\n")
#print(embeddings)

# Create a serverless index
index_name = "example-index"
if not pc.has_index(index_name):
    pc.create_index(
        name=index_name,
        dimension=1024,
        metric="cosine",
        spec=ServerlessSpec(
            cloud="aws", 
            region="us-east-1"
        ) 
    ) 

# Wait for the index to be ready
while not pc.describe_index(index_name).status['ready']:
    time.sleep(1)

# Target the index
# In production, target an index by its unique DNS host, not by its name
# See https://docs.pinecone.io/guides/data/target-an-index
index = pc.Index(index_name)

# Prepare the records for upsert
# Each contains an 'id', the vector 'values', 
# and the original text and category as 'metadata'
records = []
for d, e in zip(data, embeddings):
    records.append({
        "id": d["id"],
        "values": e["values"],
        "metadata": {
            "source_text": d["text"],
            "category": d["category"]
        }
    })

# Upsert the records into the index
index.upsert(
    vectors=records,
    namespace="example-namespace"
)

time.sleep(10)  # Wait for the upserted vectors to be indexed

print("INDEX:\n")
#print(index.describe_index_stats())

# Define your query
prompt = "Please choose one from the following queries:\nautosomal dominant / autosomal recessive\nhigh mortality / low mortality\ncomplete penetrance / incomplete penetrance / variable penetrance\ncancer / intellectual disability / spasticity / hearing loss / seizures\n"
query = input(prompt)

# Convert the query into a numerical vector that Pinecone can search with
query_embedding = pc.inference.embed(
    model="multilingual-e5-large",
    inputs=[query],
    parameters={
        "input_type": "query"
    }
)

# Search the index for the three most similar vectors
results = index.query(
    namespace="example-namespace",
    vector=query_embedding[0].values,
    top_k=3,
    include_values=False,
    include_metadata=False #put this to True, and it will show the relevant section in the text
)

print("RESULTS:\n")
print(results)

print(results)


# Rerank the search results based on their relevance to the query
# ranked_results = pc.inference.rerank(
#     model="bge-reranker-v2-m3",
#     query="Health risks",
#     documents=[
#         {"id": "rec3", "source_text": "Rich in vitamin C and other antioxidants, apples contribute to immune health and may reduce the risk of chronic diseases."},
#         {"id": "rec1", "source_text": "Apples are a great source of dietary fiber, which supports digestion and helps maintain a healthy gut."},
#         {"id": "rec4", "source_text": "The high fiber content in apples can also help regulate blood sugar levels, making them a favorable snack for people with diabetes."}
#     ],
#     top_n=3,
#     rank_fields=["source_text"],
#     return_documents=True,
#     parameters={
#         "truncate": "END"
#     }
# )

# print(ranked_results)

# Search the index with a metadata filter
# filtered_results = index.query(
#     namespace="example-namespace",
#     vector=query_embedding.data[0].values,
#     filter={
#         "category": {"$eq": "digestive system"}
#     },
#     top_k=3,
#     include_values=False,
#     include_metadata=True
# )
# print(filtered_results)
pc.delete_index(index_name)
